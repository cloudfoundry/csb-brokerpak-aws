version: 1
name: csb-aws-sqs
id: 2198d694-bf85-11ee-a918-a7bdfa69a96d
description: CSB AWS SQS
display_name: CSB AWS SQS
image_url: file://service-images/csb.png
documentation_url: https://docs.vmware.com/en/Cloud-Service-Broker-for-VMware-Tanzu/index.html
provider_display_name: VMware
support_url: https://aws.amazon.com/sqs/
tags: [aws, sqs, beta]
plan_updateable: true
provision:
  user_inputs:
    - field_name: region
      type: string
      details: The region of AWS.
      default: us-west-2
      constraints:
        examples:
          - us-west-2
          - eu-west-1
        pattern: ^[a-z][a-z0-9-]+$
      prohibit_update: true
    - field_name: fifo
      type: boolean
      details: Whether to create a FIFO queue. Cannot be altered once a queue is created.
      prohibit_update: true
      default: false
    - field_name: visibility_timeout_seconds
      type: integer
      details: The visibility timeout for the queue. An integer from 0 to 43200 (12 hours). The default for this attribute is 30.
      default: 30
    - field_name: aws_access_key_id
      type: string
      details: AWS access key
      default: ${config("aws.access_key_id")}
    - field_name: aws_secret_access_key
      type: string
      details: AWS secret key
      default: ${config("aws.secret_access_key")}
    - field_name: dlq_arn
      type: string
      details: ARN of the Dead Letter Queue. If provided, configures redrive_policy for the queue.
      default: ""
    - field_name: max_receive_count
      type: integer
      details: The number of times a message is delivered to the source queue before being moved to the DLQ.
      default: 5
  computed_inputs:
    - name: instance_name
      default: csb-sqs-${request.instance_id}
      overwrite: true
      type: string
    - name: labels
      default: ${json.marshal(request.default_labels)}
      overwrite: true
      type: object
  template_refs:
    main: terraform/sqs/provision/main.tf
    outputs: terraform/sqs/provision/outputs.tf
    provider: terraform/sqs/provision/providers.tf
    versions: terraform/sqs/provision/versions.tf
    variables: terraform/sqs/provision/variables.tf
  outputs:
    - field_name: arn
      type: string
      details: ARN for the queue
    - field_name: region
      type: string
      details: AWS region for the queue
    - field_name: queue_name
      type: string
      details: name for the queue
    - field_name: queue_url
      type: string
      details: URL for the queue
bind:
  plan_inputs: []
  user_inputs: []
  computed_inputs:
    - name: aws_access_key_id
      type: string
      default: ${config("aws.access_key_id")}
    - name: aws_secret_access_key
      type: string
      default: ${config("aws.secret_access_key")}
    - name: arn
      default: ${instance.details["arn"]}
      overwrite: true
      type: string
    - name: region
      default: ${instance.details["region"]}
      overwrite: true
      type: string
    - name: user_name
      default: csb-${request.binding_id}
      overwrite: true
      type: string
  template_refs:
    data: terraform/sqs/bind/data.tf
    main: terraform/sqs/bind/main.tf
    outputs: terraform/sqs/bind/outputs.tf
    provider: terraform/sqs/bind/provider.tf
    versions: terraform/sqs/bind/versions.tf
    variables: terraform/sqs/bind/variables.tf
  outputs:
    - field_name: access_key_id
      type: string
      details: AWS access key
    - field_name: secret_access_key
      type: string
      details: AWS secret access key
examples:
- name: standard
  description: Standard Queue
  plan_id: c2fdfc84-bf86-11ee-a4f5-8b0d531ce7e2
  provision_params: {}
  bind_params: {}
- name: fifo
  description: FIFO queue
  plan_id: 093c1060-c1c0-11ee-8b97-ff07a1127dae
  provision_params: {}
  bind_params: {}
